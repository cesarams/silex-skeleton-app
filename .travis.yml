language: php

php:
- 5.5

env:
- DB=mysql

before_script:
- composer install --dev
- composer selfupdate
- pyrus install --force phpunit/DbUnit
- phpenv rehash

- mysql -e "CREATE DATABASE IF NOT EXISTS resttestdb;" -uroot;
- mysql -e "CREATE TABLE IF NOT EXISTS resttestdb.todo (id int(11) NOT NULL AUTO_INCREMENT, name varchar(255) NOT NULL, created datetime NOT NULL, PRIMARY KEY (id)) ENGINE=InnoDB DEFAULT CHARSET=utf8;" -uroot;

- mysql -e "CREATE TABLE IF NOT EXISTS resttestdb.donatello (id int(11) NOT NULL AUTO_INCREMENT, name varchar(255) DEFAULT NULL, surname varchar(255) DEFAULT NULL, email varchar(255) DEFAULT NULL, employee_nr varchar(255) DEFAULT NULL, role tinyint(4) NOT NULL DEFAULT '0', password varchar(255) DEFAULT NULL, salt varchar(255) DEFAULT NULL, locked tinyint(4) NOT NULL DEFAULT '0', deleted tinyint(4) NOT NULL DEFAULT '0', created_by varchar(255) DEFAULT NULL, created_at char(20) DEFAULT NULL, updated_by varchar(255) DEFAULT NULL, updated_at char(20) DEFAULT NULL, PRIMARY KEY (id)) ENGINE=InnoDB DEFAULT CHARSET=utf8;" -uroot;
- mysql -e "INSERT INTO resttestdb.donatello VALUES(null, 'test_donatello_name', 'test_donatello_surname', 'test_donatello_name@email.com', 'test_donatello_employee_nr', '0', 'test_donatello_password', 'test_donatello_salt', '0', '0', 'test_donatello_created_by', '2013-01-01 00:00:00', 'test_donatello_updated_by', '2013-01-01 00:00:00'), (null, 'test_donatello_name_2', 'test_donatello_surname_2', 'test_donatello_name_2@email.com', 'test_donatello_employee_nr_2', '0', 'test_donatello_password_2', 'test_donatello_salt_2', '0', '0', 'test_donatello_created_by', '2013-01-01 00:00:00', 'test_donatello_updated_by', '2013-01-01 00:00:00');" -uroot;
- mysql -e "CREATE TABLE IF NOT EXISTS resttestdb.minerva (id int(11) NOT NULL AUTO_INCREMENT, name varchar(255) DEFAULT NULL, surname varchar(255) DEFAULT NULL, email varchar(255) DEFAULT NULL, employee_nr varchar(255) DEFAULT NULL, role tinyint(4) NOT NULL DEFAULT '0', password varchar(255) DEFAULT NULL, salt varchar(255) DEFAULT NULL, locked tinyint(4) NOT NULL DEFAULT '0', deleted tinyint(4) NOT NULL DEFAULT '0', created_by varchar(255) DEFAULT NULL, created_at char(20) DEFAULT NULL, updated_by varchar(255) DEFAULT NULL, updated_at char(20) DEFAULT NULL, PRIMARY KEY (id)) ENGINE=InnoDB DEFAULT CHARSET=utf8;" -uroot;
- mysql -e "INSERT INTO resttestdb.minerva VALUES(null, 'test_minerva_name', 'test_minerva_surname', 'test_minerva_name@email.com', 'test_minerva_employee_nr', '0', 'test_minerva_password', 'test_minerva_salt', '0', '0', 'test_minerva_created_by', '2013-01-01 00:00:00', 'test_minerva_updated_by', '2013-01-01 00:00:00'), (null, 'test_minerva_name_2', 'test_minerva_surname_2', 'test_minerva_name_2@email.com', 'test_minerva_employee_nr_2', '0', 'test_minerva_password_2', 'test_minerva_salt_2', '0', '0', 'test_minerva_created_by', '2013-01-01 00:00:00', 'test_minerva_updated_by', '2013-01-01 00:00:00');" -uroot;
- mysql -e "CREATE TABLE IF NOT EXISTS resttestdb.zeus (id int(11) NOT NULL AUTO_INCREMENT, name varchar(255) DEFAULT NULL, surname varchar(255) DEFAULT NULL, email varchar(255) DEFAULT NULL, employee_nr varchar(255) DEFAULT NULL, role tinyint(4) NOT NULL DEFAULT '0', password varchar(255) DEFAULT NULL, salt varchar(255) DEFAULT NULL, locked tinyint(4) NOT NULL DEFAULT '0', deleted tinyint(4) NOT NULL DEFAULT '0', created_by varchar(255) DEFAULT NULL, created_at char(20) DEFAULT NULL, updated_by varchar(255) DEFAULT NULL, updated_at char(20) DEFAULT NULL, PRIMARY KEY (id)) ENGINE=InnoDB DEFAULT CHARSET=utf8;" -uroot;
- mysql -e "INSERT INTO resttestdb.zeus VALUES(null, 'test_zeus_name', 'test_zeus_surname', 'test_zeus_name@email.com', 'test_zeus_employee_nr', '0', 'test_zeus_password', 'test_zeus_salt', '0', '0', 'test_zeus_created_by', '2013-01-01 00:00:00', 'test_zeus_updated_by', '2013-01-01 00:00:00'), (null, 'test_zeus_name_2', 'test_zeus_surname_2', 'test_zeus_name_2@email.com', 'test_zeus_employee_nr_2', '0', 'test_zeus_password_2', 'test_zeus_salt_2', '0', '0', 'test_zeus_created_by', '2013-01-01 00:00:00', 'test_zeus_updated_by', '2013-01-01 00:00:00');" -uroot;
- mysql -e "CREATE TABLE IF NOT EXISTS resttestdb.obsidion (id int(11) NOT NULL AUTO_INCREMENT, name varchar(255) DEFAULT NULL, surname varchar(255) DEFAULT NULL, email varchar(255) DEFAULT NULL, employee_nr varchar(255) DEFAULT NULL, role tinyint(4) NOT NULL DEFAULT '0', password varchar(255) DEFAULT NULL, salt varchar(255) DEFAULT NULL, locked tinyint(4) NOT NULL DEFAULT '0', deleted tinyint(4) NOT NULL DEFAULT '0', created_by varchar(255) DEFAULT NULL, created_at char(20) DEFAULT NULL, updated_by varchar(255) DEFAULT NULL, updated_at char(20) DEFAULT NULL, PRIMARY KEY (id)) ENGINE=InnoDB DEFAULT CHARSET=utf8;" -uroot;
- mysql -e "INSERT INTO resttestdb.obsidion VALUES(null, 'test_obsidion_name', 'test_obsidion_surname', 'test_obsidion_name@email.com', 'test_obsidion_employee_nr', '0', 'test_obsidion_password', 'test_obsidion_salt', '0', '0', 'test_obsidion_created_by', '2013-01-01 00:00:00', 'test_obsidion_updated_by', '2013-01-01 00:00:00'), (null, 'test_obsidion_name_2', 'test_obsidion_surname_2', 'test_obsidion_name_2@email.com', 'test_obsidion_employee_nr_2', '0', 'test_obsidion_password_2', 'test_obsidion_salt_2', '0', '0', 'test_obsidion_created_by', '2013-01-01 00:00:00', 'test_obsidion_updated_by', '2013-01-01 00:00:00');" -uroot;

script: phpunit -c app/